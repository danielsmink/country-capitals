"use strict";function config(e){e.when("/",{templateUrl:"./js/partials/home/home.html"}).when("/countries",{templateUrl:"./js/partials/countries/countries.html",controller:"CountriesCtrl",controllerAs:"countries"}).when("/countries/:country/capital",{templateUrl:"./js/partials/country-detail/country-detail.html",controller:"CountryDetailCtrl",controllerAs:"country"}).when("/error",{template:"<p>Error Page Not Found</p>"}).otherwise({redirectTo:"/error"})}function CountriesCtrl(e,r,t,o){var n=this,a=o.get("countries");n.isLoading=!0,n.ordering="countryName",n.go=function(r){e.path(r)},a?n.geonames=a:t.getCountries().success(function(e){o.put("countries",e.geonames),n.geonames=o.get("countries")}).error(function(){n.error="Error retrieving country list"}),r(function(){n.geonames||n.error?n.isLoading=!1:n.error="Error"},1e3)}function CountryDetailCtrl(e,r,t,o,n){var a=this,i=r.country.split("-"),u=i[0],c=n.get(u);a.isLoading=!0,o.setIsoCode(u),a.detail={country:"",capital:"",neighbours:""},a.go=function(e){t.path(e)},c?a.detail=c:o.getCountry().success(function(e){0===e.geonames.length?a.error="Error retrieving country":(a.detail.country=e.geonames[0],o.getCapital(a.detail.country).success(function(e){0===e.geonames.length?(a.detail.capital={name:"No capital",population:"0"},n.put(u,a.detail)):(a.detail.capital=e.geonames[0],o.getNeighbours(a.detail.country.geonameId).success(function(e){a.detail.neighbours=e.geonames,n.put(u,a.detail)}).error(function(){a.error="Error retrieving neighbours"}))}).error(function(){a.error="Error retrieving capital info"}))}).error(function(){a.error="Error retrieving country list"}),e(function(){a.detail||a.error?a.isLoading=!1:a.error="Error"},1e3)}function geonamesCache(e){return e(name)}function geonamesService(e,r,t){function o(){return e({method:"JSONP",url:t+"/countryInfoJSON",params:{callback:"JSON_CALLBACK",username:r}})}function n(){return e({method:"JSONP",url:t+"/countryInfoJSON",params:{callback:"JSON_CALLBACK",username:r,country:s.isoCode}})}function a(o){return e({method:"JSONP",url:t+"/searchJSON",params:{callback:"JSON_CALLBACK",username:r,q:o.capital,country:s.isoCode,name_equals:o.capital,isNameRequired:!0}})}function i(o){return e({method:"JSONP",url:t+"/neighboursJSON",params:{callback:"JSON_CALLBACK",username:r,geonameId:o}})}function u(e){s.isoCode=e}var c="",s={getCountries:o,getCountry:n,getCapital:a,getNeighbours:i,isoCode:c,setIsoCode:u};return s}angular.module("countryCapitals.config",[]).constant("geoApiUsername","danielsmink").constant("apiBaseUrl","http://api.geonames.org/"),angular.module("countryCapitals",["ngRoute","ngAnimate","countryCapitals.config"]),angular.module("countryCapitals").config(config),config.$inject=["$routeProvider"],angular.module("CountriesCtrl",CountriesCtrl),CountriesCtrl.$inject=["$location","$timeout","geonamesService","geonamesCache"],angular.module("CountryDetailCtrl",CountryDetailCtrl),CountryDetailCtrl.$inject=["$timeout","$routeParams","$location","geonamesService","geonamesCache"],angular.module("countryCapitals").factory("geonamesCache",geonamesCache),geonamesCache.$inject=["$cacheFactory"],angular.module("countryCapitals").factory("geonamesService",geonamesService),geonamesService.$inject=["$http","geoApiUsername","apiBaseUrl"];
//# sourceMappingURL=country-capitals.min.js.map