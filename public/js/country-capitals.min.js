"use strict";function config(e){e.when("/",{templateUrl:"./js/partials/home/home.html"}).when("/countries",{templateUrl:"./js/partials/countries/countries.html",controller:"CountriesCtrl",controllerAs:"countries"}).when("/countries/:country/capital",{templateUrl:"./js/partials/country-detail/country-detail.html",controller:"CountryDetailCtrl",controllerAs:"country"}).when("/error",{template:"<p>Error Page Not Found</p>"}).otherwise({redirectTo:"/error"})}function CountriesCtrl(e,r,t){var o=this,n=t.get("countries");o.ordering="countryName",o.go=function(r){e.path(r)},n?o.geonames=n:r.getCountries().success(function(e){t.put("countries",e.geonames),o.geonames=t.get("countries")}).error(function(){o.error="Error retrieving country list"})}function CountryDetailCtrl(e,r,t,o){var n=this,a=e.country.split("-"),i=a[0],c=o.get(i);t.setIsoCode(i),n.detail={country:"",capital:"",neighbours:""},n.go=function(e){r.path(e)},c?n.detail=c:t.getCountry().success(function(e){0===e.geonames.length?n.error="Error retrieving country":(n.detail.country=e.geonames[0],t.getCapital(n.detail.country).success(function(e){0===e.geonames.length?(n.detail.capital={name:"No capital",population:"0"},o.put(i,n.detail)):(n.detail.capital=e.geonames[0],t.getNeighbours(n.detail.country.geonameId).success(function(e){n.detail.neighbours=e.geonames,o.put(i,n.detail)}).error(function(){n.error="Error retrieving neighbours"}))}).error(function(){n.error="Error retrieving capital info"}))}).error(function(){n.error="Error retrieving country list"})}function geonamesCache(e){return e(name)}function geonamesService(e,r,t){function o(){return e({method:"JSONP",url:t+"/countryInfoJSON",params:{callback:"JSON_CALLBACK",username:r}})}function n(){return e({method:"JSONP",url:t+"/countryInfoJSON",params:{callback:"JSON_CALLBACK",username:r,country:s.isoCode}})}function a(o){return e({method:"JSONP",url:t+"/searchJSON",params:{callback:"JSON_CALLBACK",username:r,q:o.capital,country:s.isoCode,name_equals:o.capital,isNameRequired:!0}})}function i(o){return e({method:"JSONP",url:t+"/neighboursJSON",params:{callback:"JSON_CALLBACK",username:r,geonameId:o}})}function c(e){s.isoCode=e}var u="",s={getCountries:o,getCountry:n,getCapital:a,getNeighbours:i,isoCode:u,setIsoCode:c};return s}angular.module("countryCapitals.config",[]).constant("geoApiUsername","danielsmink").constant("apiBaseUrl","http://api.geonames.org/"),angular.module("countryCapitals",["ngRoute","ngAnimate","countryCapitals.config"]),angular.module("countryCapitals").config(config),config.$inject=["$routeProvider"],angular.module("CountriesCtrl",CountriesCtrl),CountriesCtrl.$inject=["$location","geonamesService","geonamesCache"],angular.module("CountryDetailCtrl",CountryDetailCtrl),CountryDetailCtrl.$inject=["$routeParams","$location","geonamesService","geonamesCache"],angular.module("countryCapitals").factory("geonamesCache",geonamesCache),geonamesCache.$inject=["$cacheFactory"],angular.module("countryCapitals").factory("geonamesService",geonamesService),geonamesService.$inject=["$http","geoApiUsername","apiBaseUrl"];
//# sourceMappingURL=country-capitals.min.js.map